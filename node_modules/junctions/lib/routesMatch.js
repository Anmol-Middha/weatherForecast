'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

exports.default = routesMatch;

var _TypeGuards = require('./TypeGuards');

var _Params = require('./Params');

var _objectsEqual = require('./utils/objectsEqual');

var _objectsEqual2 = _interopRequireDefault(_objectsEqual);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function routesMatch(specificRoute, partialRoute) {
  var exact = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

  var a = specificRoute;
  var b = partialRoute;

  if (!a && !b) {
    return true;
  }
  if (!a || !b) {
    return false;
  }

  if ((0, _TypeGuards.isRoute)(a) || (0, _TypeGuards.isRoute)(b)) {
    if (!(0, _TypeGuards.isRoute)(a) || !(0, _TypeGuards.isRoute)(b)) {
      return false;
    }

    if (a.branch !== b.branch) {
      return false;
    }

    var branch = a.branch;

    if (!(0, _objectsEqual2.default)((0, _Params.serializeParams)(branch.paramTypes, a.params), (0, _Params.serializeParams)(branch.paramTypes, b.params))) {
      return false;
    }

    return !branch.next || !exact && specificRoute.next && !partialRoute.next || routesMatch(a.next, b.next);
  }

  if ((typeof a === 'undefined' ? 'undefined' : _typeof(a)) !== 'object' || (typeof b === 'undefined' ? 'undefined' : _typeof(b)) !== 'object') {
    return false;
  }

  return (0, _objectsEqual2.default)(a, b, routesMatch);
}